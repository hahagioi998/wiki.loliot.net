---
id: prometheus-operator
title: prometheus-operator
sidebar_label: prometheus-operator
description: prometheus-operator
keywords:
  - prometheus-operator
---

## prometheus-operator

```shell
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
```

```shell
helm repo update
```

```shell
helm show values prometheus-community/kube-prometheus-stack \
    --version 20.0.1 \
    > prometheus-operator-values.yaml
```

```shell
mkdir -p prometheus-operator/prometheus
```

```yaml title="prometheus-operator/prometheus/namespace.yaml"
apiVersion: v1
kind: Namespace
metadata:
  name: monitoring
```

```yaml title="prometheus-operator/prometheus/values.yaml"
namespaceOverride: monitoring
fullnameOverride: prometheus-operator
defaultRules:
  create: false
global:
  rbac:
    create: true
alertmanager:
  enabled: true
grafana:
  enabled: true
kubeApiserver:
  enabled: true
kubelet:
  enabled: false
kubeControllerManager:
  enabled: false
coreDns:
  enabled: true
kubeDns:
  enabled: false
kubeEtcd:
  enabled: false
kubeScheduler:
  enabled: false
kubeProxy:
  enabled: true
kubeStateMetrics:
  enabled: false
nodeExporter:
  enabled: false
prometheusOperator:
  enabled: true
  hostNetwork: true
  tls:
    enabled: false
prometheus:
  enabled: true
  thanosService:
    enabled: false
  prometheusSpec:
    retention: 10d
    replicas: 1
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: gp2
          accessModes:
            - 'ReadWriteOnce'
          resources:
            requests:
              storage: 30Gi
```

```shell
helm template prometheus-operator prometheus-community/kube-prometheus-stack \
    --version 20.0.1 \
    -f prometheus-operator/prometheus/values.yaml \
    > prometheus-operator/prometheus/prometheus-operator.yaml
```

```yaml title="prometheus-operator/prometheus/Kustomization.yaml"
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - prometheus-operator.yaml
```

```shell
kustomize build prometheus-operator/prometheus | k apply -f -
```

## kube-state-metrics

## node-exporter
