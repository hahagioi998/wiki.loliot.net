---
id: kubernetes-dashboard
title: Kubernetes Dashboard
sidebar_label: Dashboard
description: Kubernetes Dashboard
keywords:
  - kubernetes
---

## Installation

```shell
mkdir -p monitoring/kubernetes-dashboard/base
```

```shell
wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.4.0/aio/deploy/recommended.yaml \
    -O monitoring/kubernetes-dashboard/base/kubernetes-dashboard.yaml
```

:::info
kubernetes-dashboard Deployment의 `spec.template.containers[0].args`에 `--token-ttl=<sec>`옵션을 추가해서 자동 로그아웃 시간을 조절할 수 있습니다.
:::

```yaml title="monitoring/kubernetes-dashboard/base/admin-user.yaml"
apiVersion: v1
kind: ServiceAccount
metadata:
  name: admin-user
  namespace: kubernetes-dashboard

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: admin-user
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: ServiceAccount
    name: admin-user
    namespace: kubernetes-dashboard
```

```yaml title="monitoring/kubernetes-dashboard/base/kustomization.yaml"
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - kubernetes-dashboard.yaml
  - admin-user.yaml
```

```shell
monitoring
└── kubernetes-dashboard
    └── base/
        ├── admin-user.yaml
        ├── kubernetes-dashboard.yaml
        └── kustomization.yaml
```

```shell
kubectl apply -k monitoring/kubernetes-dashboard/base
```

## Service

### Token

```shell
kubectl -n kubernetes-dashboard get secret $(kubectl -n kubernetes-dashboard get sa/admin-user -o jsonpath="{.secrets[0].name}") -o go-template="{{.data.token | base64decode}}"
```

토큰을 출력해서 사용하는 경우 위 명령어를 매번 실행하고, config파일에 저장해놓고 사용하려는 경우 아래 명령어를 통해 config파일에 토큰을 저장해두면 됩니다.

```shell
kubectl config set-credentials $(kubectl config current-context) --token=$(kubectl -n kubernetes-dashboard get secret $(kubectl -n kubernetes-dashboard get sa/admin-user -o jsonpath="{.secrets[0].name}") -o go-template="{{.data.token | base64decode}}")
```

:::warning
한 config 파일에 여러 context가 있는 경우 config파일로 로그인할 수 없습니다. 한 context에 한 config 파일로 만들고 `KUBECONFIG` 환경변수로 여러 config 파일을 묶어서 사용하는 것이 좋습니다.
:::

### Proxy

```shell
kubectl proxy
```

[http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/](http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/)

### Port forward

```shell
kubectl port-forward -n kubernetes-dashboard service/kubernetes-dashboard 8002:443
```

[https://localhost:8002](https://localhost:8002)

## Reference

- [https://github.com/kubernetes/dashboard](https://github.com/kubernetes/dashboard)
