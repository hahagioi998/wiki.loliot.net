---
id: metrics-server
title: metrics-server
sidebar_label: metrics-server
description: metrics-server
keywords:
  - metrics-server
---

## Installation

```shell
helm repo add metrics-server https://kubernetes-sigs.github.io/metrics-server/ \
&& helm repo update
```

```shell
mkdir -p monitoring/metrics-server/base
```

```shell
helm search repo metrics-server -l
```

```shell
helm show values metrics-server/metrics-server \
    --version 3.7.0 \
    > monitoring/metrics-server/base/values.yaml
```

```yaml title="monitoring/metrics-server/base/values.yaml"
# ...

defaultArgs:
  - --cert-dir=/tmp
  - --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname
  - --kubelet-use-node-status-port
  - --metric-resolution=15s
  # - --kubelet-insecure-tls
  # - --v=2
# ...
```

:::info
로그에 `"Failed to scrape node" err="Get \"https://xxx:10250/stats/summary?only_cpu_and_memory=true\": x509: cannot validate certificate for xxx because it doesn't contain any IP SANs" node="xxx"`와 같은 에러가 발생하는 경우 `--kubelet-insecure-tls`를 추가해주세요.
:::

```shell
helm upgrade metrics-server metrics-server/metrics-server \
    --install \
    --version 3.7.0 \
    -n monitoring \
    --create-namespace \
    -f monitoring/metrics-server/base/values.yaml
```

```shell
helm get manifest -n monitoring metrics-server \
    > monitoring/metrics-server/base/manifest.yaml
```

## Troubleshooting

```shell
kubectl describe apiservices v1beta1.metrics.k8s.io
```
